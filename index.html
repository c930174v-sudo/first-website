<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç…§ç‰‡æ‹–æ›³é¡¯ç¤ºå™¨</title>
    <!-- å¼•å…¥ Tailwind CSS ç¢ºä¿éŸ¿æ‡‰å¼å’Œç¾ä»£åŒ–çš„æ¨£å¼ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è¨­ç½®å…¨å±€å­—é«”ç‚º Inter */
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
        }
        /* è®“æ‹–æ›³å€çš„è™›ç·šæ¨£å¼æ›´æ¸…æ™° */
        #drop-zone {
            transition: all 0.3s ease;
        }
        .drag-over {
            border-color: #3b82f6 !important; /* æ‹–æ›³æ™‚é‚Šæ¡†è®Šè—è‰² */
            background-color: #eff6ff !important; /* æ‹–æ›³æ™‚èƒŒæ™¯è®Šæ·ºè—è‰² */
        }
    </style>
</head>
<body class="bg-gray-50 p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-2">ğŸ“¸ ç…§ç‰‡æ‹–æ›³é è¦½</h1>
            <p class="text-gray-500 text-lg">å°‡æ‚¨çš„åœ–ç‰‡æª”æ¡ˆæ‹–æ›³åˆ°ä¸‹æ–¹å€åŸŸå³å¯é¡¯ç¤ºã€‚</p>
        </header>

        <!-- æ‹–æ›³å€ (Drop Zone) -->
        <div id="drop-zone" 
             class="w-full h-64 flex items-center justify-center p-6 border-4 border-dashed border-gray-300 rounded-xl cursor-pointer hover:border-blue-400 bg-white shadow-lg mb-10">
            <p class="text-xl font-semibold text-gray-500">å°‡åœ–ç‰‡æ‹–æ›³åˆ°æ­¤è™•æˆ–é»æ“Šé¸æ“‡æª”æ¡ˆ</p>
            <!-- éš±è—çš„æª”æ¡ˆè¼¸å…¥æ¡†ï¼Œç”¨æ–¼é»æ“Šæ™‚é¸æ“‡æª”æ¡ˆ -->
            <input type="file" id="file-input" accept="image/*" multiple class="hidden">
        </div>

        <!-- åœ–ç‰‡é¡¯ç¤ºå€ (Image Display Area) -->
        <h2 class="text-2xl font-bold text-gray-800 mb-4">ğŸ–¼ï¸ è¼‰å…¥çš„åœ–ç‰‡</h2>
        <div id="image-display" 
             class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
            <!-- è¼‰å…¥çš„åœ–ç‰‡å°‡æœƒé¡¯ç¤ºåœ¨é€™è£¡ -->
        </div>

        <!-- éŒ¯èª¤æˆ–è¨Šæ¯é¡¯ç¤ºå€ -->
        <div id="message-box" class="mt-8 p-4 bg-red-100 text-red-700 border border-red-300 rounded-lg hidden">
            <!-- éŒ¯èª¤è¨Šæ¯å°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
        </div>

    </div>

    <script>
        // ç²å– DOM å…ƒç´ 
        const dropZone = document.getElementById('drop-zone');
        const imageDisplay = document.getElementById('image-display');
        const fileInput = document.getElementById('file-input');
        const messageBox = document.getElementById('message-box');

        // --- è¼”åŠ©å‡½æ•¸ ---

        // é¡¯ç¤ºè¨Šæ¯æˆ–éŒ¯èª¤
        function showMessage(text, isError = false) {
            messageBox.textContent = text;
            messageBox.className = `mt-8 p-4 rounded-lg border ${isError ? 'bg-red-100 text-red-700 border-red-300' : 'bg-green-100 text-green-700 border-green-300'}`;
            messageBox.classList.remove('hidden');
        }

        // éš±è—è¨Šæ¯æ¡†
        function hideMessage() {
            messageBox.classList.add('hidden');
        }

        // è™•ç†å–®å€‹æª”æ¡ˆçš„è®€å–èˆ‡é¡¯ç¤º
        function processFile(file) {
            // æª¢æŸ¥æª”æ¡ˆé¡å‹æ˜¯å¦ç‚ºåœ–ç‰‡
            if (!file.type.startsWith('image/')) {
                showMessage(`æª”æ¡ˆ "${file.name}" ä¸æ˜¯æœ‰æ•ˆçš„åœ–ç‰‡æ ¼å¼ã€‚`, true);
                return;
            }

            const reader = new FileReader();

            // æª”æ¡ˆè®€å–å®Œæˆå¾Œè§¸ç™¼
            reader.onload = function(e) {
                // 1. å»ºç«‹ä¸€å€‹æ–°çš„åœ–ç‰‡å®¹å™¨ (div)
                const imgContainer = document.createElement('div');
                imgContainer.className = 'bg-white p-2 rounded-lg shadow-md hover:shadow-xl transition duration-300 overflow-hidden';

                // 2. å»ºç«‹ä¸€å€‹ img å…ƒç´ 
                const img = document.createElement('img');
                img.src = e.target.result; // å°‡æª”æ¡ˆçš„ Data URL è³¦å€¼çµ¦ src
                img.alt = file.name;
                img.className = 'w-full h-auto object-cover rounded-md';

                // 3. å»ºç«‹æª”æ¡ˆåç¨±æ¨™ç±¤
                const nameTag = document.createElement('p');
                nameTag.textContent = file.name;
                nameTag.title = file.name;
                nameTag.className = 'mt-2 text-sm text-gray-600 truncate'; // truncate è®“é•·æª”åä¸æœƒæº¢å‡º

                // 4. å°‡å…ƒç´ åŠ å…¥åˆ°å®¹å™¨
                imgContainer.appendChild(img);
                imgContainer.appendChild(nameTag);

                // 5. å°‡å®¹å™¨åŠ å…¥åˆ°é¡¯ç¤ºå€çš„æœ€å‰é¢ (æœ€æ–°çš„åœ¨æœ€ä¸Šé¢)
                imageDisplay.prepend(imgContainer);
            };

            // é–‹å§‹è®€å–æª”æ¡ˆï¼Œå°‡å…¶è½‰æ›ç‚º Data URL (Base64 ç·¨ç¢¼)
            reader.readAsDataURL(file);
        }

        // è™•ç†æ‹–æ›³æˆ–é¸æ“‡çš„å¤šå€‹æª”æ¡ˆ
        function handleFiles(files) {
            hideMessage();
            if (files.length === 0) {
                showMessage("æ²’æœ‰é¸æ“‡ä»»ä½•æª”æ¡ˆã€‚", true);
                return;
            }

            let validFileCount = 0;
            for (const file of files) {
                if (file.type.startsWith('image/')) {
                    processFile(file);
                    validFileCount++;
                }
            }
            
            if (validFileCount > 0) {
                showMessage(`æˆåŠŸè¼‰å…¥ ${validFileCount} å¼µåœ–ç‰‡ï¼`, false);
            }
        }

        // --- äº‹ä»¶ç›£è½å™¨ ---

        // 1. æ‹–æ›³æª”æ¡ˆé€²å…¥ (Drag Enter/Over) äº‹ä»¶ï¼šé¡¯ç¤ºè¦–è¦ºå›é¥‹
        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, (e) => {
                e.preventDefault(); // é˜»æ­¢ç€è¦½å™¨é è¨­è¡Œç‚º
                e.stopPropagation();
                dropZone.classList.add('drag-over');
            }, false);
        });

        // 2. æ‹–æ›³æª”æ¡ˆé›¢é–‹ (Drag Leave) äº‹ä»¶ï¼šç§»é™¤è¦–è¦ºå›é¥‹
        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, (e) => {
                e.preventDefault();
                e.stopPropagation();
                dropZone.classList.remove('drag-over');
            }, false);
        });
        
        // 3. æ‹–æ›³æ”¾ä¸‹ (Drop) äº‹ä»¶ï¼šè™•ç†æª”æ¡ˆ
        dropZone.addEventListener('drop', (e) => {
            // ç²å–æ‹–æ›³é€²ä¾†çš„æª”æ¡ˆåˆ—è¡¨
            const files = e.dataTransfer.files; 
            handleFiles(files);
        }, false);
        
        // 4. é»æ“Šå€åŸŸé¸æ“‡æª”æ¡ˆ (Click to Select)
        dropZone.addEventListener('click', () => {
            // æ¨¡æ“¬é»æ“Šéš±è—çš„æª”æ¡ˆè¼¸å…¥æ¡†
            fileInput.click();
        });

        // 5. æª”æ¡ˆè¼¸å…¥æ¡†è®ŠåŒ– (File Input Change) äº‹ä»¶ï¼šè™•ç†é¸æ“‡çš„æª”æ¡ˆ
        fileInput.addEventListener('change', (e) => {
            // ç²å–ä½¿ç”¨è€…é¸æ“‡çš„æª”æ¡ˆåˆ—è¡¨
            const files = e.target.files;
            handleFiles(files);
            // æ¸…ç©ºè¼¸å…¥æ¡†ï¼Œä»¥ä¾¿å¯ä»¥å†æ¬¡é¸æ“‡ç›¸åŒçš„æª”æ¡ˆ
            e.target.value = null; 
        });

        // é¡å¤–è™•ç†æ•´å€‹è¦–çª—çš„æ‹–æ›³äº‹ä»¶ï¼Œé˜²æ­¢æ‹–æ›³åˆ°éæŒ‡å®šå€åŸŸæ™‚æª”æ¡ˆåœ¨æ–°åˆ†é æ‰“é–‹
        document.body.addEventListener('dragover', (e) => {
            e.preventDefault();
        }, false);
        document.body.addEventListener('drop', (e) => {
            e.preventDefault();
        }, false);
        
    </script>
</body>
</html>
